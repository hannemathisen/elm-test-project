var _hannemathisen$elm_test_project$Main$drawCanvas = F2(
	function (drawOps, canvas) {
		var drawOpsWithBorder = A2(
			_elm_lang$core$List$append,
			drawOps,
			{
				ctor: '::',
				_0: _hannemathisen$elm_test_project$Canvas$BeginPath,
				_1: {
					ctor: '::',
					_0: _hannemathisen$elm_test_project$Canvas$StrokeStyle(
						A3(_elm_lang$core$Color$rgb, 255, 0, 0)),
					_1: {
						ctor: '::',
						_0: _hannemathisen$elm_test_project$Canvas$LineWidth(2.0),
						_1: {
							ctor: '::',
							_0: A2(
								_hannemathisen$elm_test_project$Canvas$Rect,
								_hannemathisen$elm_test_project$Canvas_Point$fromInts(
									{ctor: '_Tuple2', _0: 0, _1: 0}),
								A2(_hannemathisen$elm_test_project$Canvas$Size, 800, 600)),
							_1: {
								ctor: '::',
								_0: _hannemathisen$elm_test_project$Canvas$Stroke,
								_1: {ctor: '[]'}
							}
						}
					}
				}
			});
		var _p0 = _hannemathisen$elm_test_project$Canvas$getSize(canvas);
		var width = _p0.width;
		var height = _p0.height;
		return A2(_hannemathisen$elm_test_project$Canvas$batch, drawOpsWithBorder, canvas);
	});
var _hannemathisen$elm_test_project$Main$presentIfReady = function (model) {
	var _p1 = model.image;
	if (_p1.ctor === 'Loading') {
		return A2(
			_elm_lang$html$Html$p,
			{ctor: '[]'},
			{
				ctor: '::',
				_0: _elm_lang$html$Html$text('Loading image...'),
				_1: {ctor: '[]'}
			});
	} else {
		var _p5 = _p1._0;
		var touchOptions = {stopPropagation: true, preventDefault: true};
		var _p2 = model.draw;
		if (_p2 === true) {
			var _p3 = model.mode;
			if (_p3.ctor === 'Draw') {
				var touchOptions = {stopPropagation: true, preventDefault: true};
				return A2(
					_hannemathisen$elm_test_project$Canvas$toHtml,
					{
						ctor: '::',
						_0: _hannemathisen$elm_test_project$Canvas_Events$onMouseUp(_hannemathisen$elm_test_project$Types$MouseUp),
						_1: {
							ctor: '::',
							_0: _hannemathisen$elm_test_project$Canvas_Events$onMouseMove(_hannemathisen$elm_test_project$Types$MouseMove),
							_1: {
								ctor: '::',
								_0: A2(_hannemathisen$elm_test_project$Canvas_Events$onMultiTouchMove, touchOptions, _hannemathisen$elm_test_project$Types$TouchMove),
								_1: {
									ctor: '::',
									_0: A2(_hannemathisen$elm_test_project$Canvas_Events$onMultiTouchEnd, touchOptions, _hannemathisen$elm_test_project$Types$TouchUp),
									_1: {
										ctor: '::',
										_0: A2(_hannemathisen$elm_test_project$Canvas_Events$onMultiTouchCancel, touchOptions, _hannemathisen$elm_test_project$Types$TouchUp),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					},
					A2(_hannemathisen$elm_test_project$Main$drawCanvas, model.drawData.drawOps, _p5));
			} else {
				return A2(
					_hannemathisen$elm_test_project$Canvas$toHtml,
					{
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$class('eraser'),
						_1: {
							ctor: '::',
							_0: _hannemathisen$elm_test_project$Canvas_Events$onMouseUp(_hannemathisen$elm_test_project$Types$MouseUp),
							_1: {
								ctor: '::',
								_0: _hannemathisen$elm_test_project$Canvas_Events$onMouseMove(_hannemathisen$elm_test_project$Types$MouseMove),
								_1: {ctor: '[]'}
							}
						}
					},
					A2(_hannemathisen$elm_test_project$Main$drawCanvas, model.drawData.drawOps, _p5));
			}
		} else {
			var _p4 = model.mode;
			if (_p4.ctor === 'Draw') {
				var touchOptions = {stopPropagation: true, preventDefault: true};
				return A2(
					_hannemathisen$elm_test_project$Canvas$toHtml,
					{
						ctor: '::',
						_0: _hannemathisen$elm_test_project$Canvas_Events$onMouseDown(_hannemathisen$elm_test_project$Types$MouseDown),
						_1: {
							ctor: '::',
							_0: A2(_hannemathisen$elm_test_project$Canvas_Events$onMultiTouchStart, touchOptions, _hannemathisen$elm_test_project$Types$TouchDown),
							_1: {ctor: '[]'}
						}
					},
					A2(_hannemathisen$elm_test_project$Main$drawCanvas, model.drawData.drawOps, _p5));
			} else {
				return A2(
					_hannemathisen$elm_test_project$Canvas$toHtml,
					{
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$class('eraser'),
						_1: {
							ctor: '::',
							_0: _hannemathisen$elm_test_project$Canvas_Events$onMouseDown(_hannemathisen$elm_test_project$Types$MouseDown),
							_1: {ctor: '[]'}
						}
					},
					A2(_hannemathisen$elm_test_project$Main$drawCanvas, model.drawData.drawOps, _p5));
			}
		}
	}
};
var _hannemathisen$elm_test_project$Main$view = function (model) {
	var _p6 = model.mode;
	if (_p6.ctor === 'Draw') {
		return A2(
			_elm_lang$html$Html$div,
			{ctor: '[]'},
			{
				ctor: '::',
				_0: A2(
					_elm_lang$html$Html$div,
					{ctor: '[]'},
					{
						ctor: '::',
						_0: _hannemathisen$elm_test_project$Main$presentIfReady(model),
						_1: {ctor: '[]'}
					}),
				_1: {
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$div,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: A2(
								_elm_lang$html$Html$button,
								{
									ctor: '::',
									_0: _elm_lang$html$Html_Attributes$class('btn'),
									_1: {
										ctor: '::',
										_0: _hannemathisen$elm_test_project$Canvas_Events$onClick(_hannemathisen$elm_test_project$Types$EraseClicked),
										_1: {ctor: '[]'}
									}
								},
								{
									ctor: '::',
									_0: _elm_lang$html$Html$text('Erase is off'),
									_1: {ctor: '[]'}
								}),
							_1: {ctor: '[]'}
						}),
					_1: {ctor: '[]'}
				}
			});
	} else {
		return A2(
			_elm_lang$html$Html$div,
			{ctor: '[]'},
			{
				ctor: '::',
				_0: A2(
					_elm_lang$html$Html$div,
					{ctor: '[]'},
					{
						ctor: '::',
						_0: _hannemathisen$elm_test_project$Main$presentIfReady(model),
						_1: {ctor: '[]'}
					}),
				_1: {
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$div,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: A2(
								_elm_lang$html$Html$button,
								{
									ctor: '::',
									_0: _elm_lang$html$Html_Attributes$class('btn'),
									_1: {
										ctor: '::',
										_0: _hannemathisen$elm_test_project$Canvas_Events$onClick(_hannemathisen$elm_test_project$Types$EraseClicked),
										_1: {ctor: '[]'}
									}
								},
								{
									ctor: '::',
									_0: _elm_lang$html$Html$text('Erase is on'),
									_1: {ctor: '[]'}
								}),
							_1: {ctor: '[]'}
						}),
					_1: {ctor: '[]'}
				}
			});
	}
};
var _hannemathisen$elm_test_project$Main$mapXPoints = F2(
	function (xList, yList) {
		var _p7 = xList;
		if (_p7.ctor === '[]') {
			return _elm_lang$core$Native_Utils.crashCase(
				'Main',
				{
					start: {line: 314, column: 3},
					end: {line: 326, column: 35}
				},
				_p7)('Empty list');
		} else {
			if (_p7._1.ctor === '[]') {
				return A3(
					_elm_lang$core$List$map2,
					F2(
						function (v0, v1) {
							return {ctor: '_Tuple2', _0: v0, _1: v1};
						}),
					{
						ctor: '::',
						_0: _p7._0,
						_1: {ctor: '[]'}
					},
					yList);
			} else {
				var mappedList = A3(
					_elm_lang$core$List$map2,
					F2(
						function (v0, v1) {
							return {ctor: '_Tuple2', _0: v0, _1: v1};
						}),
					{
						ctor: '::',
						_0: _p7._0,
						_1: {ctor: '[]'}
					},
					yList);
				return A2(
					_elm_lang$core$List$append,
					mappedList,
					A2(_hannemathisen$elm_test_project$Main$mapXPoints, _p7._1, yList));
			}
		}
	});
var _hannemathisen$elm_test_project$Main$mapYPoints = F2(
	function (xList, yList) {
		var _p9 = yList;
		if (_p9.ctor === '[]') {
			return _elm_lang$core$Native_Utils.crashCase(
				'Main',
				{
					start: {line: 331, column: 3},
					end: {line: 343, column: 35}
				},
				_p9)('Empty list');
		} else {
			if (_p9._1.ctor === '[]') {
				return A2(
					_hannemathisen$elm_test_project$Main$mapXPoints,
					xList,
					{
						ctor: '::',
						_0: _p9._0,
						_1: {ctor: '[]'}
					});
			} else {
				var mappedList = A2(
					_hannemathisen$elm_test_project$Main$mapXPoints,
					xList,
					{
						ctor: '::',
						_0: _p9._0,
						_1: {ctor: '[]'}
					});
				return A2(
					_elm_lang$core$List$append,
					mappedList,
					A2(_hannemathisen$elm_test_project$Main$mapYPoints, xList, _p9._1));
			}
		}
	});
var _hannemathisen$elm_test_project$Main$removePoints = F2(
	function (drawOps, points) {
		removePoints:
		while (true) {
			var _p11 = points;
			if (_p11.ctor === '[]') {
				return _elm_lang$core$Native_Utils.crashCase(
					'Main',
					{
						start: {line: 292, column: 3},
						end: {line: 308, column: 37}
					},
					_p11)('Empty list');
			} else {
				if (_p11._1.ctor === '[]') {
					var point = _hannemathisen$elm_test_project$Canvas_Point$fromFloats(_p11._0);
					return A3(
						_hannemathisen$elm_test_project$List_Extra$replaceIf,
						function (x) {
							return _elm_lang$core$Native_Utils.eq(
								x,
								_hannemathisen$elm_test_project$Canvas$LineTo(point));
						},
						_hannemathisen$elm_test_project$Canvas$MoveTo(point),
						drawOps);
				} else {
					var point = _hannemathisen$elm_test_project$Canvas_Point$fromFloats(_p11._0);
					var newDrawOps = A3(
						_hannemathisen$elm_test_project$List_Extra$replaceIf,
						function (x) {
							return _elm_lang$core$Native_Utils.eq(
								x,
								_hannemathisen$elm_test_project$Canvas$LineTo(point));
						},
						_hannemathisen$elm_test_project$Canvas$MoveTo(point),
						drawOps);
					var _v8 = newDrawOps,
						_v9 = _p11._1;
					drawOps = _v8;
					points = _v9;
					continue removePoints;
				}
			}
		}
	});
var _hannemathisen$elm_test_project$Main$erase = F2(
	function (point, drawOps) {
		var _p13 = _hannemathisen$elm_test_project$Canvas_Point$toInts(point);
		var x = _p13._0;
		var y = _p13._1;
		var xPoints = A2(
			_elm_lang$core$List$map,
			_elm_lang$core$Basics$toFloat,
			A2(_elm_lang$core$List$range, x - 3, x + 3));
		var yPoints = A2(
			_elm_lang$core$List$map,
			_elm_lang$core$Basics$toFloat,
			A2(_elm_lang$core$List$range, y - 3, y + 3));
		var points = A2(_hannemathisen$elm_test_project$Main$mapYPoints, xPoints, yPoints);
		return A2(_hannemathisen$elm_test_project$Main$removePoints, drawOps, points);
	});
var _hannemathisen$elm_test_project$Main$draw = F3(
	function (point, canvas, drawOps) {
		return A2(
			_elm_lang$core$List$append,
			drawOps,
			{
				ctor: '::',
				_0: _hannemathisen$elm_test_project$Canvas$LineTo(point),
				_1: {
					ctor: '::',
					_0: _hannemathisen$elm_test_project$Canvas$Stroke,
					_1: {ctor: '[]'}
				}
			});
	});
var _hannemathisen$elm_test_project$Main$concatDrawOps = function (drawOps) {
	return A2(
		_elm_lang$core$Basics_ops['++'],
		{
			ctor: '::',
			_0: _hannemathisen$elm_test_project$Canvas$BeginPath,
			_1: {
				ctor: '::',
				_0: _hannemathisen$elm_test_project$Canvas$LineWidth(3),
				_1: {
					ctor: '::',
					_0: _hannemathisen$elm_test_project$Canvas$StrokeStyle(_elm_lang$core$Color$red),
					_1: {
						ctor: '::',
						_0: _hannemathisen$elm_test_project$Canvas$LineCap('round'),
						_1: {ctor: '[]'}
					}
				}
			}
		},
		A2(
			_elm_lang$core$Basics_ops['++'],
			drawOps,
			{
				ctor: '::',
				_0: _hannemathisen$elm_test_project$Canvas$Stroke,
				_1: {ctor: '[]'}
			}));
};
var _hannemathisen$elm_test_project$Main$pointDataToLineOperations = function (pointData) {
	var _p14 = pointData.points;
	if (_p14.ctor === '[]') {
		return {ctor: '[]'};
	} else {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: _hannemathisen$elm_test_project$Canvas$MoveTo(_p14._0),
				_1: {ctor: '[]'}
			},
			A2(
				_elm_lang$core$List$map,
				function (point) {
					return _hannemathisen$elm_test_project$Canvas$LineTo(point);
				},
				_p14._1));
	}
};
var _hannemathisen$elm_test_project$Main$loadImage = A2(
	_elm_lang$core$Task$attempt,
	_hannemathisen$elm_test_project$Types$ImageLoaded,
	_hannemathisen$elm_test_project$Canvas$loadImage('white.png'));
var _hannemathisen$elm_test_project$Main$update = F2(
	function (msg, model) {
		var _p15 = msg;
		switch (_p15.ctor) {
			case 'ImageLoaded':
				var _p16 = _elm_lang$core$Result$toMaybe(_p15._0);
				if (_p16.ctor === 'Just') {
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Native_Utils.update(
							model,
							{
								mode: _hannemathisen$elm_test_project$Types$Draw,
								image: _hannemathisen$elm_test_project$Types$GotCanvas(_p16._0)
							}),
						_1: _elm_lang$core$Platform_Cmd$none
					};
				} else {
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Native_Utils.update(
							model,
							{image: _hannemathisen$elm_test_project$Types$Loading}),
						_1: _hannemathisen$elm_test_project$Main$loadImage
					};
				}
			case 'MouseDown':
				return {
					ctor: '_Tuple2',
					_0: _elm_lang$core$Native_Utils.update(
						model,
						{draw: true}),
					_1: _elm_lang$core$Platform_Cmd$none
				};
			case 'MouseUp':
				var newCurrentPointData = {
					position: model.drawData.currentPointData.position,
					points: {ctor: '[]'}
				};
				var drawData = model.drawData;
				var newDrawData = _elm_lang$core$Native_Utils.update(
					drawData,
					{
						allPointData: {ctor: '::', _0: model.drawData.currentPointData, _1: model.drawData.allPointData},
						currentPointData: newCurrentPointData
					});
				return {
					ctor: '_Tuple2',
					_0: _elm_lang$core$Native_Utils.update(
						model,
						{draw: false, drawData: newDrawData}),
					_1: _elm_lang$core$Platform_Cmd$none
				};
			case 'MouseMove':
				var _p19 = _p15._0;
				var _p17 = model.mode;
				if (_p17.ctor === 'Draw') {
					var _p18 = model.draw;
					if (_p18 === true) {
						var pointData = model.drawData.currentPointData;
						var lineDrawOps = _elm_lang$core$List$concat(
							A2(
								_elm_lang$core$List$map,
								function (pointData) {
									return _hannemathisen$elm_test_project$Main$pointDataToLineOperations(pointData);
								},
								{ctor: '::', _0: pointData, _1: model.drawData.allPointData}));
						var newDrawOps = _hannemathisen$elm_test_project$Main$concatDrawOps(lineDrawOps);
						var newPoints = A2(
							_elm_lang$core$Basics_ops['++'],
							model.drawData.currentPointData.points,
							{
								ctor: '::',
								_0: _p19,
								_1: {ctor: '[]'}
							});
						var newPointData = _elm_lang$core$Native_Utils.update(
							pointData,
							{points: newPoints});
						return {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Native_Utils.update(
								model,
								{
									drawData: {currentPointData: newPointData, drawOps: newDrawOps, allPointData: model.drawData.allPointData}
								}),
							_1: _elm_lang$core$Platform_Cmd$none
						};
					} else {
						return {ctor: '_Tuple2', _0: model, _1: _elm_lang$core$Platform_Cmd$none};
					}
				} else {
					var drawData = model.drawData;
					var newDrawOps = A2(_hannemathisen$elm_test_project$Main$erase, _p19, drawData.drawOps);
					var newDrawData = _elm_lang$core$Native_Utils.update(
						drawData,
						{drawOps: newDrawOps});
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Native_Utils.update(
							model,
							{mode: _hannemathisen$elm_test_project$Types$Erase, drawData: newDrawData}),
						_1: _elm_lang$core$Platform_Cmd$none
					};
				}
			case 'TouchDown':
				var _p20 = _p15._0.points;
				if (_p20.ctor === '[]') {
					return {ctor: '_Tuple2', _0: model, _1: _elm_lang$core$Platform_Cmd$none};
				} else {
					var newCurrentPointData = A2(
						_elm_lang$core$Debug$log,
						'newCurrentPointData',
						{
							position: model.drawData.currentPointData.position,
							points: {ctor: '[]'}
						});
					var drawData = model.drawData;
					var newDrawData = _elm_lang$core$Native_Utils.update(
						drawData,
						{
							allPointData: A2(
								_elm_lang$core$Basics_ops['++'],
								model.drawData.allPointData,
								{
									ctor: '::',
									_0: model.drawData.currentPointData,
									_1: {ctor: '[]'}
								}),
							currentPointData: newCurrentPointData
						});
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Native_Utils.update(
							model,
							{draw: true, drawData: newDrawData}),
						_1: _elm_lang$core$Platform_Cmd$none
					};
				}
			case 'TouchUp':
				var _p21 = _p15._0.points;
				if (_p21.ctor === '[]') {
					return {ctor: '_Tuple2', _0: model, _1: _elm_lang$core$Platform_Cmd$none};
				} else {
					if (_p21._1.ctor === '[]') {
						return {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Native_Utils.update(
								model,
								{draw: false}),
							_1: _elm_lang$core$Platform_Cmd$none
						};
					} else {
						return {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Native_Utils.update(
								model,
								{draw: false}),
							_1: _elm_lang$core$Platform_Cmd$none
						};
					}
				}
			case 'TouchMove':
				var _p22 = _p15._0.points;
				if (_p22.ctor === '[]') {
					return {ctor: '_Tuple2', _0: model, _1: _elm_lang$core$Platform_Cmd$none};
				} else {
					if (_p22._1.ctor === '[]') {
						var pointData = model.drawData.currentPointData;
						var lineDrawOps = _elm_lang$core$List$concat(
							A2(
								_elm_lang$core$List$map,
								function (pointData) {
									return _hannemathisen$elm_test_project$Main$pointDataToLineOperations(pointData);
								},
								{ctor: '::', _0: pointData, _1: model.drawData.allPointData}));
						var newDrawOps = _hannemathisen$elm_test_project$Main$concatDrawOps(lineDrawOps);
						var _p23 = _hannemathisen$elm_test_project$Canvas_Point$toFloats(_p22._0);
						var x = _p23._0;
						var y = _p23._1;
						var newPoint = _hannemathisen$elm_test_project$Canvas_Point$fromFloats(
							{ctor: '_Tuple2', _0: x - model.drawData.currentPointData.position.x, _1: y - model.drawData.currentPointData.position.y});
						var newPoints = A2(
							_elm_lang$core$Basics_ops['++'],
							model.drawData.currentPointData.points,
							{
								ctor: '::',
								_0: newPoint,
								_1: {ctor: '[]'}
							});
						var newPointData = _elm_lang$core$Native_Utils.update(
							pointData,
							{points: newPoints});
						return {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Native_Utils.update(
								model,
								{
									drawData: {currentPointData: newPointData, drawOps: newDrawOps, allPointData: model.drawData.allPointData}
								}),
							_1: _elm_lang$core$Platform_Cmd$none
						};
					} else {
						return {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Native_Utils.update(
								model,
								{draw: false}),
							_1: _elm_lang$core$Platform_Cmd$none
						};
					}
				}
			default:
				var _p24 = model.mode;
				if (_p24.ctor === 'Draw') {
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Native_Utils.update(
							model,
							{mode: _hannemathisen$elm_test_project$Types$Erase}),
						_1: _elm_lang$core$Platform_Cmd$none
					};
				} else {
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Native_Utils.update(
							model,
							{mode: _hannemathisen$elm_test_project$Types$Draw}),
						_1: _elm_lang$core$Platform_Cmd$none
					};
				}
		}
	});
var _hannemathisen$elm_test_project$Main$init = function () {
	var model = {mode: _hannemathisen$elm_test_project$Types$Draw, drawData: _hannemathisen$elm_test_project$Types$initDrawData, draw: false, image: _hannemathisen$elm_test_project$Types$Loading};
	return {ctor: '_Tuple2', _0: model, _1: _hannemathisen$elm_test_project$Main$loadImage};
}();
var _hannemathisen$elm_test_project$Main$main = _elm_lang$html$Html$program(
	{
		init: _hannemathisen$elm_test_project$Main$init,
		view: _hannemathisen$elm_test_project$Main$view,
		update: _hannemathisen$elm_test_project$Main$update,
		subscriptions: _elm_lang$core$Basics$always(_elm_lang$core$Platform_Sub$none)
	})();
